# yaml-language-server: $schema=./values.schema.json
image:
  repository: docker.io/vshadbolt/strapi
  tag: 5.36.1-alpine@sha256:34ff6e241bbc3d33d78124aa0ab6900b7513db8eacdd5447d216cc7514f8090a
  pullPolicy: Always
service:
  main:
    ports:
      main:
        port: 1337
persistence:
  data:
    enabled: true
    mountPath: /srv/app
# Enabled postgres
cnpg:
  main:
    enabled: true
    user: strapi
    database: strapi

securityContext:
  container:
    readOnlyRootFilesystem: false
    runAsNonRoot: false
    runAsUser: 0
    runAsGroup: 0
workload:
  main:
    podSpec:
      containers:
        main:
          env:
            PORT: "{{ .Values.service.main.ports.main.port }}"
            DATABASE_CLIENT: postgres
            DATABASE_PORT: 5432
            DATABASE_NAME: "{{ .Values.cnpg.main.database }}"
            DATABASE_HOST:
              secretKeyRef:
                name: cnpg-main-urls
                key: host
            DATABASE_USERNAME: "{{ .Values.cnpg.main.user }}"
            DATABASE_PASSWORD:
              secretKeyRef:
                name: cnpg-main-user
                key: password
            # STRAPI_LICENSE
            # PUBLIC_URL
            NODE_ENV: development
            STRAPI_DISABLE_UPDATE_NOTIFICATION: true
            FAST_REFRESH: false
            EXTRA_ARGS: ""
            JWT_SECRET: my_jwt_secret
            ADMIN_JWT_SECRET: my_admin_jwt_secret
            APP_KEYS: '["keya", "keyb"]'
